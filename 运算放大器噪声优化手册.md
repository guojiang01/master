# 运算放大器噪声优化手册 9787115307774

operational amplifier noise : techniques and tips for analyzing and reducing noise

1. 热噪声在时域和统计学中的显示![热噪声在时域和统计学中的显示.png](https://s2.loli.net/2023/09/03/iJrPwxUjGRH6aYX.png) 

2. 热噪声公式：$e_n=\sqrt{4\cdot k \cdot T \cdot R \cdot \Delta f}$，$e_n$是RMS噪声电压，$T$是以开尔文(K)为单位的温度，R是以欧姆$(\Omega)$为单位的电阻，$\Delta f$是以赫兹(HZ)为单位的噪声带宽，K是玻尔兹曼常数(J/K) $1.380649\times10^{-23}m^2kg s^{-2}K^{-1}$。

3. 噪声概率密度函数：$f(x)=\frac{1}{\sigma\cdot \sqrt{2\pi}}\cdot e^{[-(x-\mu)^2/2\sigma^2]}$ ，$f(x)$是x在任意时间间隔内被测量到的概率，x是随机常数，$\mu$是平均数，$\sigma$是标准差。

4. 概率分布函数是概率密度函数的积分：$P(a<x<b)=\int^b_af(x)dx=\int^b_a\frac{1}{\sigma\cdot \sqrt{2\pi}}\cdot e^{[-(x-\mu)^2/2\sigma^2]}dx$ . 概率分布函数有助于我们将均方根噪声转化为峰峰值噪声或者电流噪声。注意到高斯分布的两端是无限延伸的，这说明任何电压的噪声都是有可能出现的。虽然理论上是这样，但是实际上瞬时产生极大电压噪声的概率非常小。例如测量到的噪声电压幅度在$-3\sigma $~$3\sigma$之间的概率是99.7%。换句话说，测量到噪声电压幅度在这个范围外的概率只有0.3%。因此$\pm3\sigma即(6\sigma)$经常被用来估算噪声信号的峰峰值。68%的噪声集中在$2\sigma$范围内。

   | 标准差倍数                   | 测量电压几率(%) |
   | ---------------------------- | --------------- |
   | $2\sigma$即$\pm\sigma$       | 68.3            |
   | $3\sigma$即$\pm 1.5\sigma$   | 86.6            |
   | $4\sigma$即$\pm 2\sigma$     | 95.4            |
   | $5\sigma$即$\pm 2.5\sigma$   | 98.8            |
   | $6\sigma$即$\pm 3\sigma$     | 99.7            |
   | $6.6\sigma$即$\pm 3.3\sigma$ | 99.9            |

   最后一个涉及的统计学概念是噪声信号的叠加。在进行两个信号的叠加时，我们必须知道这两个信号是否相关。分别产生于两个独立噪声源的噪声信号之间是不相关的。例如，从两个独立电阻或两个运放产生的噪声是不相关的。反馈机制可以使得噪声源变得相关。

   叠加两个相关噪声：$e_{nT}=\sqrt{e_{n1}^2+e_{n2}^2+2Ce_{n1}e_{n2}}$.

   叠加两个不相关噪声：$e_{nT}=\sqrt{e_{n1}^2+e_{n2}^2}$.

5. 噪声的频域表示：噪声的一个重要特点就是它的频谱密度。电压噪声频谱密度是每平方根赫兹测量到的RMS电压噪声（或通常表示为$nV/\sqrt{Hz}$）。功率谱密度以W/Hz表示。

   ![运放噪声频谱密度.png](https://s2.loli.net/2023/09/03/zSPCO3AEIvqejZb.png)  

   上图显示了频谱密度曲线的两个常见区域。在宽带区域内噪声频谱密度是平坦的，即所有不同频点因素的贡献是相同的。运放还可能有频谱密度曲线不平的低频噪声区，这个噪声叫1/f噪声、闪烁噪声或低频噪声。通常，1/f噪声的功率频谱以斜率1/f滚降，这意味着电压频谱以斜率1/f滚降，然而实际上1/f方程的指数会有轻微偏差。频谱密度图中同时也显示了电流噪声（以$fA/\sqrt{Hz}$为单位）。随时间缓慢变化是1/f噪声的特点。

6. 通过频谱密度计算均方根噪声

   三种不同形式的功率频谱密度：噪声功率频谱密度(单位$W/\sqrt{Hz}$)、噪声电压频谱密度(单位$V/\sqrt{Hz}$)和噪声电流频谱密度(单位$V/\sqrt{Hz}$)。通过对频谱密度积分可以将功率频谱密度转化成RMS功率。功率频谱密度定义为电压频谱密度或者电流频谱密度的平方。$噪声功率=\int^{f2}_{f1}e_n^2df$,$噪声电压=\sqrt{\int^{f2}_{f1}e_n^2df}$.$e_n$为噪声电压频谱密度。对电压频谱密度平方后积分得到噪声功率，然后开根号得到噪声电压。

7. 噪声带宽和信号带宽：$BW_n=f_H\cdot K_n$，$f_H$是高频截止频率，$K_n$是砖墙转换因子。

   | 滤波器极点数（阶数） | KnAC噪声带宽比 |
   | -------------------- | -------------- |
   | 1                    | 1.57           |
   | 2                    | 1.22           |
   | 3                    | 1.16           |
   | 4                    | 1.13           |
   | 5                    | 1.12           |

8. 宽带均方根噪声计算：$E_{nBB}=e_{BB}\cdot \sqrt{BW_n}$，$e_{BB}宽带噪声电压密度(V/\sqrt{Hz})$,$BW_n 给定系统的噪声带宽(HZ)$。

   1Hz归一化1/f噪声：$e_{fnorm}=e_{at\_f}\cdot \sqrt f$，$e_{at\_f}$是1/f区域某频点的电压噪声密度，f是1/f区域中噪声密度已知的某个频率。如果手册给出最低1Hz数据，直接读取即可。如果手册给出最低0.1Hz需要按照1Hz进行归一化计算。

   $E_{nf}=e_{fnorm}\cdot \sqrt{ln(\frac{f_H}{f_L})}$，测量到的1/f RMS噪声，单位为V。$e_{fnorm}$是从上式得到的1Hz归一化噪声，$f_H$是工作频率上限（使用噪声带宽$BW_n$)，$f_L$是工作频率下限（通常选择0.1Hz）。

9. 将简单运放的电流噪声转换成电压噪声（RTI）

   宽带RMS噪声电流：$I_{nBB}=i_{nBB}\cdot\sqrt{BW_n}$，

   从电流噪声源看到的等效电阻：$R_{eq}=\frac{R_f\cdot R_1}{R_f+R_1}$，

   1Hz归一化的1/f噪声：$i_{fnorm}=i_{at\_f}\cdot\sqrt f$，

   放大器测量到的1/f RMS噪声：$i_{nt}=i_{fnorm}\cdot\sqrt{ln(\frac{f_H}{f_L})}$，

   电流噪声导致的总RMS噪声：$ln=\sqrt{l_{nf}^2+l_{nBB}^2}$，

   电流噪声导致的RMS噪声电压：$E_{n\_i}=l_n\cdot R_{eq}$.

   $i_{nBB}$为电流噪声宽带频谱密度；$i_{at\_f}$为is区域中的电流噪声频谱密度；f为测量电流噪声频谱密度$i_{at\_f}$处的频率；$BW_n$为噪声带宽；$R_f$为反馈电阻；$R_1$为输入电阻。

10. 热噪声：

    来自运放反馈网络的总RMS噪声：$E_{n\_r}=\sqrt{4kT\cdot R_{eq}\cdot BW_n}$，

    从电流源噪声源端看到的等效电阻：$R_{eq}=\frac{R_f \cdot R_1}{R_f+R_1}$。

    k为玻尔兹曼常数$(1.38\times10^{-23}J/K)$，T为开尔文温度，$R_{eq}$为等效电阻，$BW_N$为噪声带宽。

11. 合并所有噪声并计算峰峰值输出噪声

    折合到输入端的总RMS噪声：$E_{n\_in}=\sqrt{E_{n\_i}^2+E_{n\_v}^2+E_{n\_r}^2}$，

    折合到输出端的总RMS噪声：$E_{n\_out}=E_{n\_in}\cdot噪声增益$，

    峰峰值输出电压：$E_{n\_out\_pp}=E_{n\_out}\cdot 6.0$.

12. 计算噪声带宽：

    1. 运放带宽限制：闭环带宽=$\frac{增益带宽积}{噪声增益}$，闭环带宽=$\frac{16MHz}{101}=158KHz$.
    2. 计算总运放电压噪声分布
       1. 宽带电压噪声部分
          1. 噪声带宽：$BW_n=f_H \cdot K_n$，$BW_n=(158KHz)\cdot (1.57)=248KHz$。
          2. 来自电压噪声的总带宽噪声：$E_{nBB}=e_{BB} \cdot \sqrt{BW_n}$，$E_{nBB}=(5\frac{nV}{\sqrt{Hz}})\sqrt{248KHz}=2490nV_{RMS}$。
       2. 1/f电压噪声部分
          1. 对1Hz归一化的1/f噪声：$e_{fnorm}=e_{at\_f}\cdot\sqrt f$，$e_{fnorm}=(50\frac{nV}{\sqrt{Hz}})\cdot\sqrt{1Hz}=50nV$.
          2. 来自电压的噪声的总1/f噪声：$E_{nf}= e_{fnorm} \cdot \sqrt{ln(\frac{f_H}{f_L})}$ ，$E_{nf}=(50nV)\cdot\sqrt{ln(\frac{248KHz}{0.1Hz})}=191.8nV_{RMS}$。
       3. 总电压噪声（折合到运放输入端）：
          1. 来自电压噪声的总RMS噪声：$E_{n\_v}=\sqrt{E_{nf}^2+E_{nBB}^2}$，$E_{n\_v}=\sqrt{(2490nV_{RMS})^2+(191.8nV_{RMS})^2}=2497nV_{RMS}$.

13. 从规格书中获取关键噪声指标：

    1. 宽带电流噪声部分：$BW_n=f_H\cdot K_n$

       ​				  $BW_n=(158KHz)\cdot(1.57)=248KHz$

       ​				  $I_{nBB}=i_{nBB}\sqrt{BW_n}$

       ​				  $I_{nBB}=(2.5\frac{fA}{\sqrt{Hz}})\sqrt{248KHz}=1.244pA_{RMS}$ 

       ​				  $I_{nf}=0A$ 没有1/f噪声

       ​				  $I_n=\sqrt{I_{nf}^2+I_{nBB}^2}$

       ​				  $I_n=1.244pA_{RMS}$

       ​				  $R_{eq}=R_1||R_2$

       ​				  $R_{eq}=\frac{R_f\cdot R_1}{R_f+R_1}=\frac{100K\Omega \cdot 1k\Omega}{100k\Omega+1k\Omega}$ 

       ​				  $E_{n\_i}=I_n\cdot R_{eq}$

       ​				  $E_{n\_i}=(1.244pA_{RMS})(0.99k\Omega)=1.23nV_{RMS}$ 

       将电流噪声频谱密度转换成等效噪声电压

14. 计算运放总电流噪声分布：我们需要将电流噪声转换成折合到输入端（RTI）电压噪声。首先，我们将电流噪声频谱密度转换成电流源，通过将电流源乘以等效输入电阻来计算输入电压噪声。需要注意的是JEFT放大器通常没有1/f电流噪声。

15. 计算总热噪声分布，热噪声（电阻噪声）部分：

    ​	$BW_n=f_H\cdot K_n$

    ​	$BW_n=(158kHz)(1.57)=248kHz$

    ​	$R_{eq}=R_1||R_f$

    ​	$R_{eq}=\frac{R_f\cdot R_1}{R_f+R_1}=\frac{(100K\Omega)(1K\Omega)}{100K\Omega+1K\Omega}$ 

    ​	$E_{n\_r}=\sqrt{4kTR_{eq}\Delta f}$

    ​	$E_{n\_r}=\sqrt{4(1.38\times10^{-23}J/K)(298K)(0.99K\Omega)(248KHz)}=2010nV_{RMS}$ 

    将电阻噪声转换为等效噪声电压。因为总电压噪声为2497nV，所以电阻噪声电压2010nV很重要。

16. 将所有噪声源叠加并计算输出峰峰值噪声

    ​	运放RTI电压噪声：$E_{n\_v}=2497nV_{RMS}$

    ​	运放RTI电流噪声：$E_{n\_i}=1.23nV_{RMS}$

    ​	运放RTI电阻噪声：$E_{n\_r}=2010nV_{RMS}$

    ​	总RTI RMS噪声：$E_{n\_in}=\sqrt{E_{n\_v}^2+E_{n\_i}^2+E_{n\_r}^2}=3205nV_{RMS}$ 

    ​	总RTO RMS噪声：$E_{n\_out}=E_{n\_in}\cdot 增益=3205\cdot 101=324\mu V_{RMS}$ 

    ​	估计总RTO峰峰值噪声：$E_{n\_out\_pp}=E_{n\_out}\cdot 6 = (324\mu V_{RMS})\cdot 6=1.94mV_{pp}$  

17. 二级放大器：第二级放大器噪声对总噪声并没有明显的影响。这是因为出入级噪声在和第二季噪声叠加前被放大了101倍。通常情况下，输入级噪声起决定性作用。特别是在第一级放大器增益很高的时候。

18. + 没有其他的滤波器时，放大器的增益带宽决定了噪声带宽
    + 一个简单的RC滤波器就可以控制噪声带宽
    + 在两级放大器中，输入级对噪声起决定性作用
    + 通过计算可以洞察噪声的主要来源
    + 当源电阻很大时，电流噪声或电阻噪声可能是主要噪声来源
    + 当源电阻很小并且反馈网络电阻也很小时，电压噪声通常是主要噪声来源